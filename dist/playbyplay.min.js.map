{"version":3,"sources":["playbyplay.js","playbyplay.min.js"],"names":["global","factory","exports","module","define","amd","playbyplay","this","append","run","options","callback","setTimeout","localhistory","key","show","cb","opts","fillShowOptions","load","err","runs","onShow","showRuns","parent","document","body","hide","reverse","container","createElement","id","containerId","innerHTML","containerInnerHTML","addEventListener","e","target","className","clear","index","getAttribute","appendChild","getElementById","parentNode","removeChild","escapeClass","str","String","replace","escapeHTML","div","createTextNode","length","runsHTML","emptyHTML","map","runHTML","join","statusClass","input","output","status","supported"],"mappings":"CAAC,SAAUA,EAAQC,GACI,gBAAZC,UAA0C,mBAAXC,QAAyBF,EAAQC,SACrD,kBAAXE,SAAyBA,OAAOC,IAAMD,QAAQ,WAAYH,GACjEA,EAASD,EAAOM,gBAClBC,KAAM,SAAUL,GA4Cd,QAASM,GAAOC,EAAKC,EAASC,GAC1BC,WAAW,WACPC,aAAaL,OAAOM,EAAKL,EAAKC,EAASC,IACxC,GAKP,QAASI,GAAKL,EAASC,GACnB,GAAMK,GAAwB,kBAAZN,GAAyBA,EAAUC,EAC/CM,EAAOC,EAAmC,gBAAZR,GAAuBA,KAE3DG,cAAaM,KAAKL,EAAK,SAACM,EAAKC,GACzB,MAAID,QACIH,EAAKK,QACLL,EAAKK,OAAOF,QAIpBG,GAASF,EAAMJ,EAAMD,KAI7B,QAASE,GAAgBR,GAIrB,MAHKA,GAAQc,SACTd,EAAQc,OAASC,SAASC,MAEvBhB,EAGX,QAASa,GAASF,EAAMX,EAASC,GAC7BgB,IAGAN,EAAKO,SAEL,IAAMC,GAAYJ,SAASK,cAAc,MAEzCD,GAAUE,GAAKC,EACfH,EAAUI,UAAYC,EAAmBb,GAEzCQ,EAAUM,iBAAiB,QAAS,SAAAC,GAChC,OAAQA,GAAKA,EAAEC,QAAUD,EAAEC,OAAOC,WAC9B,IAAK,oCAGD,MAFAX,SACAhB,GAAS,KAGb,KAAK,qCAKD,MAJAgB,SACAY,GAAM,WACFxB,EAAKJ,IAIb,KAAK,uCAGD,GAAM6B,GAAQJ,EAAEC,OAAOI,aAAa,aAGpC,OAFAd,SACAhB,GAAS,KAAMU,EAAKmB,OAG7B,EAEH,IAAIpB,GAAM,IACV,KACIV,EAAQc,OAAOkB,YAAYb,GAC7B,MAAOO,GACLhB,EAAMgB,EAGN1B,EAAQY,QACRZ,EAAQY,OAAOF,GAIvB,QAASO,KACL,IACI,GAAME,GAAYJ,SAASkB,eAAeX,EAC1CH,GAAUe,WAAWC,YAAYhB,GACnC,MAAOO,KAGb,QAASG,GAAM5B,GACXE,aAAa0B,MAAMzB,EAAKH,GA/H5B,GAAMmC,GAAc,SAAAC,GCDhB,MDCuBC,QAAOD,GAAKE,QAAQ,aAAc,KAEvDC,EAAa,SAAAH,GACf,GAAMI,GAAM1B,SAASK,cAAc,MAEnC,OADAqB,GAAIT,YAAYjB,SAAS2B,eAAeL,IACjCI,EAAIlB,WAGTC,EAAqB,SAAAb,GCCvB,MDAJ,wEACGA,EAAKgC,OAASC,EAASjC,GAAQkC,IAE5BD,EAAW,SAAAjC,GCCb,MAAO,2GDETA,EAAKmC,IAAIC,GAASC,KAAK,IAAG,cAGtBD,EAAU,SAAChD,EAAK+B,GCDlB,MAAO,6BDEkBmB,EAAYlD,GAAI,mGAELyC,EAAWzC,EAAImD,OAAM,oHAG3BV,EAAWzC,EAAIoD,QAAO,gIAGerB,EAAK,gEAMtEmB,EAAc,SAAAlD,GCZhB,MDYuBA,GAAIqD,OAAM,qBAAwBhB,EAAYrC,EAAIqD,QAAY,IAEnFP,EAAS,0DAETzC,EAAM,kCACNkB,EAAc,aAEd+B,EAAYlD,aAAakD,SA0F/B7D,GAAQ6D,UAAYA,EACpB7D,EAAQM,OAASA,EACjBN,EAAQa,KAAOA,EACfb,EAAQqC,MAAQA","file":"playbyplay.min.js","sourcesContent":["(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n    typeof define === 'function' && define.amd ? define(['exports'], factory) :\n    factory((global.playbyplay = {}))\n}(this, function (exports) {\n\n    const escapeClass = str => String(str).replace(/[^a-z0-9]/g, '');\n\n    const escapeHTML = str => {\n        const div = document.createElement('div');\n        div.appendChild(document.createTextNode(str));\n        return div.innerHTML;\n    };\n\n    const containerInnerHTML = runs =>\n    `<button class=\"playbyplay-button playbyplay-hide\">&lt; Back</button>` +\n    `${runs.length ? runsHTML(runs) : emptyHTML}`;\n\n    const runsHTML = runs =>\n    `<button class=\"playbyplay-button playbyplay-clear\">Clear</button>\n<table class=\"playbyplay-runs\">\n    ${runs.map(runHTML).join('')}\n</table>`;\n\n    const runHTML = (run, index) =>\n    `<tr class=\"playbyplay-run ${statusClass(run)}\">\n    <td class=\"playbyplay-col playbyplay-input\">\n        <pre class=\"playbyplay-pre\"><code>${escapeHTML(run.input)}</code></pre>\n    </td>\n    <td class=\"playbyplay-col playbyplay-output\">\n        <pre class=\"playbyplay-pre\">${escapeHTML(run.output)}</pre>\n    </td>\n    <td class=\"playbyplay-col\">\n        <button class=\"playbyplay-button playbyplay-restore\" data-index=\"${index}\">\n            Restore\n        </button>\n    </td>\n</tr>`;\n\n    const statusClass = run => run.status ? `playbyplay-status-${escapeClass(run.status)}` : '';\n\n    const emptyHTML = `<span class=\"playbyplay-empty\">History is empty.</span>`;\n\n    const key = 'playbyplay_0fE#n9asNy4^MD1jfj&!';\n    const containerId = 'playbyplay';\n\n    const supported = localhistory.supported;\n\n    function append(run, options, callback) {\n        setTimeout(() => {\n            localhistory.append(key, run, options, callback);\n        }, 0);\n    }\n\n    // options is optional, callback is required. Usually, required arguments go first, but having the\n    // callback last leads to cleaner calling code with closures.\n    function show(options, callback) {\n        const cb = typeof options === 'function' ? options : callback;\n        const opts = fillShowOptions(typeof options === 'object' ? options : {});\n\n        localhistory.load(key, (err, runs) => {\n            if (err) {\n                if (opts.onShow) {\n                    opts.onShow(err);\n                }\n                return;\n            }\n            showRuns(runs, opts, cb);\n        });\n    }\n\n    function fillShowOptions(options) {\n        if (!options.parent) {\n            options.parent = document.body;\n        }\n        return options;\n    }\n\n    function showRuns(runs, options, callback) {\n        hide();\n\n        // The most recently appended runs should be on top.\n        runs.reverse();\n\n        const container = document.createElement('div');\n\n        container.id = containerId;\n        container.innerHTML = containerInnerHTML(runs);\n\n        container.addEventListener('click', e => {\n            switch (e && e.target && e.target.className) {\n                case 'playbyplay-button playbyplay-hide':\n                    hide();\n                    callback(null);\n                    return;\n\n                case 'playbyplay-button playbyplay-clear':\n                    hide();\n                    clear(() => {\n                        show(callback);\n                    });\n                    return;\n\n                case 'playbyplay-button playbyplay-restore':\n                    // Use getAttribute instead of dataset for compatibility:\n                    // http://caniuse.com/#feat=dataset\n                    const index = e.target.getAttribute('data-index');\n                    hide();\n                    callback(null, runs[index]);\n                    return;\n            }\n        }, false);\n\n        let err = null;\n        try {\n            options.parent.appendChild(container);\n        } catch (e) {\n            err = e;\n        }\n\n        if (options.onShow) {\n            options.onShow(err);\n        }\n    }\n\n    function hide() {\n        try {\n            const container = document.getElementById(containerId);\n            container.parentNode.removeChild(container);\n        } catch (e) {}\n    }\n\n    function clear(callback) {\n        localhistory.clear(key, callback);\n    }\n\n    exports.supported = supported;\n    exports.append = append;\n    exports.show = show;\n    exports.clear = clear;\n\n}));\n","!function(t,n){\"object\"==typeof exports&&\"undefined\"!=typeof module?n(exports):\"function\"==typeof define&&define.amd?define([\"exports\"],n):n(t.playbyplay={})}(this,function(t){function n(t,n,a){setTimeout(function(){localhistory.append(b,t,n,a)},0)}function a(t,n){var a=\"function\"==typeof t?t:n,y=e(\"object\"==typeof t?t:{});localhistory.load(b,function(t,n){return t?void(y.onShow&&y.onShow(t)):void l(n,y,a)})}function e(t){return t.parent||(t.parent=document.body),t}function l(t,n,e){y(),t.reverse();var l=document.createElement(\"div\");l.id=f,l.innerHTML=u(t),l.addEventListener(\"click\",function(n){switch(n&&n.target&&n.target.className){case\"playbyplay-button playbyplay-hide\":return y(),void e(null);case\"playbyplay-button playbyplay-clear\":return y(),void p(function(){a(e)});case\"playbyplay-button playbyplay-restore\":var l=n.target.getAttribute(\"data-index\");return y(),void e(null,t[l])}},!1);var o=null;try{n.parent.appendChild(l)}catch(r){o=r}n.onShow&&n.onShow(o)}function y(){try{var t=document.getElementById(f);t.parentNode.removeChild(t)}catch(n){}}function p(t){localhistory.clear(b,t)}var o=function(t){return String(t).replace(/[^a-z0-9]/g,\"\")},r=function(t){var n=document.createElement(\"div\");return n.appendChild(document.createTextNode(t)),n.innerHTML},u=function(t){return'<button class=\"playbyplay-button playbyplay-hide\">&lt; Back</button>'+(t.length?c(t):d)},c=function(t){return'<button class=\"playbyplay-button playbyplay-clear\">Clear</button>\\n<table class=\"playbyplay-runs\">\\n    '+t.map(i).join(\"\")+\"\\n</table>\"},i=function(t,n){return'<tr class=\"playbyplay-run '+s(t)+'\">\\n    <td class=\"playbyplay-col playbyplay-input\">\\n        <pre class=\"playbyplay-pre\"><code>'+r(t.input)+'</code></pre>\\n    </td>\\n    <td class=\"playbyplay-col playbyplay-output\">\\n        <pre class=\"playbyplay-pre\">'+r(t.output)+'</pre>\\n    </td>\\n    <td class=\"playbyplay-col\">\\n        <button class=\"playbyplay-button playbyplay-restore\" data-index=\"'+n+'\">\\n            Restore\\n        </button>\\n    </td>\\n</tr>'},s=function(t){return t.status?\"playbyplay-status-\"+o(t.status):\"\"},d='<span class=\"playbyplay-empty\">History is empty.</span>',b=\"playbyplay_0fE#n9asNy4^MD1jfj&!\",f=\"playbyplay\",h=localhistory.supported;t.supported=h,t.append=n,t.show=a,t.clear=p});\n//# sourceMappingURL=playbyplay.min.js.map"],"sourceRoot":"/source/"}