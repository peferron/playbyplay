{"version":3,"sources":["playbyplay.js"],"names":[],"mappings":"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","file":"playbyplay.js","sourcesContent":["(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n    typeof define === 'function' && define.amd ? define(['exports'], factory) :\n    factory((global.playbyplay = {}))\n}(this, function (exports) {\n\n    const escapeClass = str => String(str).replace(/[^a-z0-9]/g, '');\n\n    const escapeHTML = str => {\n        const div = document.createElement('div');\n        div.appendChild(document.createTextNode(str));\n        return div.innerHTML;\n    };\n\n    const containerInnerHTML = runs =>\n    `<button class=\"playbyplay-button playbyplay-hide\">&lt; Back</button>` +\n    `${runs.length ? runsHTML(runs) : emptyHTML}`;\n\n    const runsHTML = runs =>\n    `<button class=\"playbyplay-button playbyplay-clear\">Clear</button>\n<table class=\"playbyplay-runs\">\n    ${runs.map(runHTML).join('')}\n</table>`;\n\n    const runHTML = (run, index) =>\n    `<tr class=\"playbyplay-run ${statusClass(run)}\">\n    <td class=\"playbyplay-col playbyplay-input\">\n        <pre class=\"playbyplay-pre\"><code>${escapeHTML(run.input)}</code></pre>\n    </td>\n    <td class=\"playbyplay-col playbyplay-output\">\n        <pre class=\"playbyplay-pre\">${escapeHTML(run.output)}</pre>\n    </td>\n    <td class=\"playbyplay-col\">\n        <button class=\"playbyplay-button playbyplay-restore\" data-index=\"${index}\">\n            Restore\n        </button>\n    </td>\n</tr>`;\n\n    const statusClass = run => run.status ? `playbyplay-status-${escapeClass(run.status)}` : '';\n\n    const emptyHTML = `<span class=\"playbyplay-empty\">History is empty.</span>`;\n\n    const key = 'playbyplay_0fE#n9asNy4^MD1jfj&!';\n    const containerId = 'playbyplay';\n\n    const supported = localhistory.supported;\n\n    function append(run, options, callback) {\n        setTimeout(() => {\n            localhistory.append(key, run, options, callback);\n        }, 0);\n    }\n\n    // options is optional, callback is required. Usually, required arguments go first, but having the\n    // callback last leads to cleaner calling code with closures.\n    function show(options, callback) {\n        const cb = typeof options === 'function' ? options : callback;\n        const opts = fillShowOptions(typeof options === 'object' ? options : {});\n\n        localhistory.load(key, (err, runs) => {\n            if (err) {\n                if (opts.onShow) {\n                    opts.onShow(err);\n                }\n                return;\n            }\n            showRuns(runs, opts, cb);\n        });\n    }\n\n    function fillShowOptions(options) {\n        if (!options.parent) {\n            options.parent = document.body;\n        }\n        return options;\n    }\n\n    function showRuns(runs, options, callback) {\n        hide();\n\n        // The most recently appended runs should be on top.\n        runs.reverse();\n\n        const container = document.createElement('div');\n\n        container.id = containerId;\n        container.innerHTML = containerInnerHTML(runs);\n\n        container.addEventListener('click', e => {\n            switch (e && e.target && e.target.className) {\n                case 'playbyplay-button playbyplay-hide':\n                    hide();\n                    callback(null);\n                    return;\n\n                case 'playbyplay-button playbyplay-clear':\n                    hide();\n                    clear(() => {\n                        show(callback);\n                    });\n                    return;\n\n                case 'playbyplay-button playbyplay-restore':\n                    // Use getAttribute instead of dataset for compatibility:\n                    // http://caniuse.com/#feat=dataset\n                    const index = e.target.getAttribute('data-index');\n                    hide();\n                    callback(null, runs[index]);\n                    return;\n            }\n        }, false);\n\n        let err = null;\n        try {\n            options.parent.appendChild(container);\n        } catch (e) {\n            err = e;\n        }\n\n        if (options.onShow) {\n            options.onShow(err);\n        }\n    }\n\n    function hide() {\n        try {\n            const container = document.getElementById(containerId);\n            container.parentNode.removeChild(container);\n        } catch (e) {}\n    }\n\n    function clear(callback) {\n        localhistory.clear(key, callback);\n    }\n\n    exports.supported = supported;\n    exports.append = append;\n    exports.show = show;\n    exports.clear = clear;\n\n}));\n"],"sourceRoot":"./"}